{
  "metadata": {
    "name": "PhishGuard",
    "version": "1.0.0",
    "updated_at": "2025-09-14"
  },

  "thresholds": {
    "safe_max": 2.0,
    "phishing_min": 2.0
  },

  "domain_canonicalization": {
    "idn_to_ascii": true,
    "compare_on_registrable_domain": true,
    "treat_subdomain_as_trusted_when_whitelisted": true,
    "etld_exceptions": ["co.uk", "com.au", "com.sg", "gov.sg"]
  },

  "rules": {
    "whitelist": {
      "enabled": true,
      "domains": {
        "nus.edu.sg": ["meds"],
        "sit.edu.sg": [],
        "microsoft.com": [],
        "google.com": [],
        "paypal.com": [],
        "singpass.gov.sg": [],
        "gov.sg": [],
        "ntu.edu.sg": [],
        "smu.edu.sg": [],
        "suss.edu.sg": [],
        "uobgroup.com": [],
        "dbs.com": [],
        "ocbc.com": [],
        "maybank.com": [],
        "hsbc.com.sg": [],
        "apple.com": [],
        "amazon.com": [],
        "facebook.com": [],
        "linkedin.com": [],
        "github.com": [],
        "dropbox.com": [],
        "adobe.com": [],
        "zoom.us": [],
        "outlook.com": [],
        "yahoo.com": [],
        "gov.uk": [],
        "gov.au": []
      },
      "include_subdomains": false,
      "score_delta_on_match": -0.5,
      "emailaddr_penalty": 0.9,
      "suspicious_email_localpart":[
     "sex", "xxx", "porn", "nude", "adult", "erotic", "horny", "dating", "hookup", "milf", "teen",
    "loan", "credit", "cash", "money", "creditcard", "paypal", "bitcoin", "free", "prize", "reward", "bonus", "jackpot", "millionaire",
     "offer", "deal", "discount", "cheap", "win", "giveaway", "promo", "click", "urgent", "important", "alert", "limited",
     "casino", "poker", "betting", "roulette", "blackjack", "lottery","smoking",
     "aaa", "xxx", "girl_with_toys", "hot_babe", "sexy_queen",
     "admin", "support", "service", "helpdesk", "security", "verification", "update", "account", "login", "bank"
 ]
    },

    "headers":{
      "enabled":true,
      "from_header_mismatch":0.5,
      "reply_to_mismatch": 0.5,
      "to_header_penalty": 0.5,
      "max_hops_penalty": 0.3,
      "max_hops": 5

    },

    "keywords": {
      "enabled": true,
      "case_insensitive": true,
      "max_total": 2.0,
      "weights": {
        "urgent": 0.8,
        "immediately": 0.6,
        "verify your account": 1.0,
        "update your password": 0.9,
        "unusual activity": 0.7,
        "your account will be closed": 1.2,
        "payment failed": 0.8,
        "reset now": 0.8,
        "click here": 0.7,
        "login to your account": 0.9,
        "confirm your identity": 1.0,
        "security alert": 0.8,
        "account suspended": 1.1,
        "action required": 0.7,
        "verify now": 0.9,
        "limited time": 0.6,
        "update information": 0.8,
        "account locked": 1.1,
        "unauthorized access": 0.9,
        "reactivate account": 1.0,
        "final notice": 0.8,
        "your account has been compromised": 1.2,
        "suspicious login": 0.9,
        "confirm password": 0.8,
        "secure your account": 0.9,
        "validate your details": 0.8,
        "verify your identity": 1.0,
        "account verification": 1.0,
        "update account": 0.8,
        "account update": 0.8,
        "password expired": 1.0,
        "reset password": 0.9,
        "security breach": 1.1,
        "account alert": 0.8,
        "login alert": 0.8,
        "verify details": 0.8,
        "confirm account": 0.9,
        "account activity": 0.7,
        "account review": 0.7,
        "account access": 0.8,
        "identity verification": 1.0,
        "account information": 0.7,
        "security warning": 0.9,
        "account expired": 1.0,
        "account deactivated": 1.1,
        "account termination": 1.2,
        "account disabled": 1.1,
        "account issue": 0.8,
        "account problem": 0.8,
        "security issue": 0.9,
        "security problem": 0.9,
        "login required": 0.8,
        "verify email": 0.8,
        "confirm email": 0.8,
        "update email": 0.7,
        "update credentials": 0.8,
        "validate account": 0.9,
        "validate credentials": 0.9,
        "verify credentials": 0.9,
        "account confirmation": 1.0,
        "security check": 0.8,
        "security update": 0.8,
        "guarenteed": 0.7,
        "winner": 0.8,
        "cash":0.4,
        "credit":0.2,
        "free":0.7,
        "gift":0.5,
        "guarantee":0.5,
        "loan":0.4,
        "lose":0.3, 
        "money":0.4,
        "offer":0.3,
        "low price":0.5,
        "special price":0.5,
        "chance":0.5,
        "congratulations":1.0,
        "deal":0.4,
        "exclusive":0.3,
        "limited":0.4,
        "opportunity":0.3,
        "special":0.3,
        "success":0.3,
        "cancer":0.7,
        "natural":0.7,
        "risk": 0.6,
        "herbal":1.5,
        "drug":1.4,
        "antivirus":0.7,
        "data":0.4,
        "protect":0.3,
        "secure":0.4,
        "software":0.8,
        "membership":0.3,
        "join":0.4,
        "sale":0.5,
        "porn":2.0,
        "cock":2.0,
        "pussy":2.0,
        "friend":2.0,
        "toys":0.7,
        "income": 0.4,
        "excellent income": 0.7,
        "fuck": 2.0
      },
      "count": {
        "per_phrase_max": 2,
        "use_word_boundaries": true
      },
      "position": {
        "subject_boost": 1.5,
        "intro_chars": 200,
        "intro_boost": 1.25,
        "body_boost": 1.0,
        "allcaps_subject_penalty": 1.5
      }
      
    
    },

    "reply_to_mismatch": {
      "enabled": true,
      "ignore_if_same_registrable_domain": true,
      "score_delta": 1.5,
      "severity": "HIGH"
    },

    "display_name_impersonation": {
      "enabled": true,
      "protected_display_names": [
        "PayPal",
        "Google",
        "Microsoft",
        "Singpass",
        "IT Support",
        "HR"
      ],
      "score_delta": 1.2,
      "severity": "MEDIUM"
    },

    "lookalike_domain": {
      "enabled": true,
      "protected_domains": [
        "paypal.com",
        "google.com",
        "microsoft.com",
        "singpass.gov.sg"
      ],
      "max_edit_distance": 1,
      "score_distance_1": 2.5,
      "score_distance_2": 3.5,
      "tld_swap_penalty": 1.0,
      "homograph_confusables": ["l:I", "rn:m", "0:o", "1:l", "5:s"],
      "severity_if_distance_1": "HIGH",
      "severity_if_distance_2": "CRITICAL"
    },

    "url_redflags": {
      "enabled": true,
      "ip_url_penalty": 1.5,
      "at_symbol_penalty": 1.5,
      "subdomain_limit_penalty": 2.0,
      "shortener_domains": [
        "bit.ly",
        "tinyurl.com",
        "t.co",
        "goo.gl",
        "ow.ly",
        "is.gd",
        "buff.ly"
      ],
      "shortener_penalty": 1.5,
      "mismatch_label_href_penalty": 2.0,
      "suspicious_tlds": ["zip", "top", "xyz", "ru", "cn", "kim","ws","zw", "bd", "ke", "am", "sbs", "date", "pw", "quest", "cd", "bid",
    "support", "win", "rest", "casa", "help", "ml", "ws", "icu", "tokyo",
    "xyz", "cam", "cm", "uno", "email", "stream", "cyou", "gq", "cf",
    "ga", "info", "su", "best"],
      "suspicious_tld_penalty": 1.0,
      "suspicious_keyword_path": [
    "login", "signin", "account", "verify", "password", "update-account",
    "banking", "paypal", "creditcard", "payment", "billing",
    "personal-info", "profile-update", "free", "gift", "prize", "clickhere",
    "update", "secure", "bank", "remove"
],
      "keyword_penalty": 1.0
    },

    "attachments": {
      "enabled": true,
      "risky_extensions": [
        ".exe",
        ".js",
        ".vbs",
        ".scr",
        ".bat",
        ".cmd",
        ".com",
        ".pif",
        ".jar",
        ".ps1",
        ".lnk",
        ".iso",
        ".img",
        ".hta",
        ".html",
        ".htm",
        ".docm",
        ".xlsm",
        ".pptm"
      ],
      "score_per_match": 2.0,
      "severity": "HIGH",
      "max_files_scored": 5
    },

    "auth_results": {
      "enabled": true,
      "spf_fail_penalty": 1.0,
      "dkim_fail_penalty": 1.2,
      "dmarc_fail_penalty": 1.5,
      "all_pass_bonus": -0.5,
      "treat_none_as": "neutral"
    },

    "html_heuristics": {
      "enabled": true,
      "form_tag_penalty": 1.5,
      "onclick_js_penalty": 1.0,
      "data_uri_penalty": 1.0,
      "hidden_text_ratio_threshold": 0.6,
      "hidden_text_penalty": 1.0
    },

    "obfuscation": {
      "enabled": true,
      "zero_width_chars_penalty": 1.0,
      "unicode_homoglyph_penalty": 1.2,
      "char_repeat_threshold": 10,
      "char_repeat_penalty": 0.8
    }
  },

  "logging": {
    "level": "INFO",
    "to_file": true,
    "file_path": "out/phishguard.log",
    "rotate_max_bytes": 1048576,
    "rotate_backups": 3
  },

  "output": {
    "json_dir": "out/json",
    "csv_path": "out/results.csv",
    "timestamped_json": true
  },

  "cli": {
    "batch_glob": "*.eml",
    "fail_fast": false
  },

  "dataset": {
    "tags": {
      "enron": "ham",
      "spamassassin": "phish"
    }
  }
}

{
  "metadata": {
    "name": "PhishGuard",
    "version": "1.0.0",
    "updated_at": "2025-09-14"
  },

  "thresholds": {
    "safe_max": 2.0,
    "phishing_min": 2.0
  },

  "domain_canonicalization": {
    "idn_to_ascii": true,
    "compare_on_registrable_domain": true,
    "treat_subdomain_as_trusted_when_whitelisted": true,
    "etld_exceptions": ["co.uk", "com.au", "com.sg", "gov.sg"]
  },

  "rules": {
    "whitelist": {
      "enabled": true,
      "domains": {
        "nus.edu.sg": ["meds"],
        "sit.edu.sg": [],
        "microsoft.com": [],
        "google.com": [],
        "paypal.com": [],
        "singpass.gov.sg": [],
        "gov.sg": [],
        "ntu.edu.sg": [],
        "smu.edu.sg": [],
        "suss.edu.sg": [],
        "uobgroup.com": [],
        "dbs.com": [],
        "ocbc.com": [],
        "maybank.com": [],
        "hsbc.com.sg": [],
        "apple.com": [],
        "amazon.com": [],
        "facebook.com": [],
        "linkedin.com": [],
        "github.com": [],
        "dropbox.com": [],
        "adobe.com": [],
        "zoom.us": [],
        "outlook.com": [],
        "yahoo.com": [],
        "gov.uk": [],
        "gov.au": []
      },
      "include_subdomains": false,
      "score_delta_on_match": -0.5
    },

    "keywords": {
      "enabled": true,
      "case_insensitive": true,
      "max_total": 2.0,
      "weights": {
        "urgent": 0.8,
        "immediately": 1.2,
        "verify your account": 1.0,
        "update your password": 0.9,
        "unusual activity": 0.9,
        "your account will be closed": 1.2,
        "payment failed": 1.0,
        "reset now": 0.8,
        "click here": 0.8,
        "login to your account": 1.0,
        "confirm your identity": 1.0,
        "security alert": 0.9,
        "account suspended": 1.4,
        "action required": 1.0,
        "verify now": 1.0,
        "limited time": 1.2,
        "update information": 1.0,
        "account locked": 1.3,
        "unauthorized access": 1.0,
        "reactivate account": 1.0,
        "final notice": 1.2,
        "your account has been compromised": 1.2,
        "suspicious login": 1.0,
        "confirm password": 0.8,
        "secure your account": 0.9,
        "validate your details": 0.9,
        "verify your identity": 1.0,
        "account verification": 1.0,
        "update account": 0.9,
        "account update": 0.8,
        "password expired": 1.0,
        "reset password": 0.9,
        "security breach": 1.2,
        "account alert": 0.9,
        "login alert": 0.8,
        "verify details": 0.8,
        "confirm account": 0.9,
        "account activity": 0.8,
        "account review": 0.7,
        "account access": 1.0,
        "identity verification": 1.0,
        "account information": 0.7,
        "security warning": 0.9,
        "account expired": 1.0,
        "account deactivated": 1.1,
        "account termination": 1.2,
        "account disabled": 1.1,
        "account issue": 0.9,
        "account problem": 0.9,
        "security issue": 1.0,
        "security problem": 1.0,
        "login required": 0.9,
        "verify email": 0.9,
        "confirm email": 0.9,
        "update email": 0.8,
        "update credentials": 1.0,
        "validate account": 1.0,
        "validate credentials": 1.0,
        "verify credentials": 1.0,
        "account confirmation": 1.0,
        "security check": 0.9,
        "security update": 0.9,
        "guaranteed": 1.2,
        "winner": 1.4,
        "cash": 0.8,
        "credit": 0.7,
        "free": 1.2,
        "gift": 1.3,
        "guarantee": 1.4,
        "loan": 0.6,
        "lose": 0.8,
        "money": 0.8,
        "offer": 0.7,
        "low price": 0.6,
        "special price": 0.6,
        "chance": 0.8,
        "congratulations": 1.2,
        "deal": 0.6,
        "exclusive": 0.4,
        "limited": 0.6,
        "opportunity": 0.8,
        "special": 0.6,
        "success": 0.5,
        "cancer": 1.2,
        "natural": 1.2,
        "risk": 0.9,
        "herbal": 1.5,
        "drug": 1.4,
        "antivirus": 1.1,
        "data": 0.8,
        "protect": 0.9,
        "secure": 0.9,
        "software": 1.1,
        "membership": 0.7,
        "join": 1.0,
        "sale": 0.8,
        "porn": 2.0,
        "friend": 2.0,
        "financial": 1.1,
        "savings": 1.1,
        "Protecting": 1.2,
        "Protect": 1.2,
        "Investment": 1.0,
        "Cancer": 1.5,
        "Slim": 1.0,
        "Child Support": 1.2,
        "Singles": 1.5,
        "Price": 1.2
      },
      "count": {
        "per_phrase_max": 2,
        "use_word_boundaries": true
      },
      "position": {
        "subject_boost": 1.5,
        "intro_chars": 200,
        "intro_boost": 1.25,
        "body_boost": 1.0,
        "allcaps_subject_penalty": 0.5
      }
    },

    "reply_to_mismatch": {
      "enabled": true,
      "ignore_if_same_registrable_domain": true,
      "score_delta": 1.5,
      "severity": "HIGH"
    },

    "display_name_impersonation": {
      "enabled": true,
      "protected_display_names": [
        "PayPal",
        "Google",
        "Microsoft",
        "Singpass",
        "IT Support",
        "HR"
      ],
      "score_delta": 1.2,
      "severity": "MEDIUM"
    },

    "lookalike_domain": {
      "enabled": true,
      "protected_domains": [
        "paypal.com",
        "google.com",
        "microsoft.com",
        "singpass.gov.sg"
      ],
      "max_edit_distance": 1,
      "score_distance_1": 2.5,
      "score_distance_2": 3.5,
      "tld_swap_penalty": 1.0,
      "homograph_confusables": ["l:I", "rn:m", "0:o", "1:l", "5:s"],
      "severity_if_distance_1": "HIGH",
      "severity_if_distance_2": "CRITICAL"
    },

    "url_redflags": {
      "enabled": true,
      "ip_url_penalty": 1.5,
      "at_symbol_penalty": 1.5,
      "subdomain_limit_penalty": 2.0,
      "shortener_domains": [
        "bit.ly",
        "tinyurl.com",
        "t.co",
        "goo.gl",
        "ow.ly",
        "is.gd",
        "buff.ly"
      ],
      "shortener_penalty": 1.5,
      "mismatch_label_href_penalty": 2.0,
      "suspicious_tlds": [
        "zip",
        "top",
        "xyz",
        "ru",
        "cn",
        "kim",
        "ws",
        "zw",
        "bd",
        "ke",
        "am",
        "sbs",
        "date",
        "pw",
        "quest",
        "cd",
        "bid",
        "support",
        "win",
        "rest",
        "casa",
        "help",
        "ml",
        "ws",
        "icu",
        "tokyo",
        "xyz",
        "cam",
        "cm",
        "uno",
        "email",
        "stream",
        "cyou",
        "gq",
        "cf",
        "ga",
        "info",
        "su",
        "best"
      ],
      "suspicious_tld_penalty": 1.0,
      "suspicious_keyword_path": [
        "login",
        "signin",
        "account",
        "verify",
        "password",
        "update-account",
        "banking",
        "paypal",
        "creditcard",
        "payment",
        "billing",
        "personal-info",
        "profile-update",
        "free",
        "gift",
        "prize",
        "clickhere",
        "update",
        "secure",
        "bank",
        "remove"
      ],
      "keyword_penalty": 1.0
    },

    "attachments": {
      "enabled": true,
      "risky_extensions": [
        ".exe",
        ".js",
        ".vbs",
        ".scr",
        ".bat",
        ".cmd",
        ".com",
        ".pif",
        ".jar",
        ".ps1",
        ".lnk",
        ".iso",
        ".img",
        ".hta",
        ".html",
        ".htm",
        ".docm",
        ".xlsm",
        ".pptm"
      ],
      "score_per_match": 2.0,
      "severity": "HIGH",
      "max_files_scored": 5
    },

    "auth_results": {
      "enabled": true,
      "spf_fail_penalty": 1.0,
      "dkim_fail_penalty": 1.2,
      "dmarc_fail_penalty": 1.5,
      "all_pass_bonus": -0.5,
      "treat_none_as": "neutral"
    },

    "html_heuristics": {
      "enabled": true,
      "form_tag_penalty": 1.5,
      "onclick_js_penalty": 1.0,
      "data_uri_penalty": 1.0,
      "hidden_text_ratio_threshold": 0.6,
      "hidden_text_penalty": 1.0
    },

    "obfuscation": {
      "enabled": true,
      "zero_width_chars_penalty": 1.0,
      "unicode_homoglyph_penalty": 1.2,
      "char_repeat_threshold": 10,
      "char_repeat_penalty": 0.8
    }
  },

  "logging": {
    "level": "INFO",
    "to_file": true,
    "file_path": "out/phishguard.log",
    "rotate_max_bytes": 1048576,
    "rotate_backups": 3
  },

  "output": {
    "json_dir": "out/json",
    "csv_path": "out/results.csv",
    "timestamped_json": true
  },

  "cli": {
    "batch_glob": "*.eml",
    "fail_fast": false
  },

  "dataset": {
    "tags": {
      "enron": "ham",
      "spamassassin": "phish"
    }
  }
}
